<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>User Dashboard - SSC Result Portal</title>
<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(to right, #e3f2fd, #e0f7fa);
    margin: 0; padding: 20px; max-width: 500px; margin-left: auto; margin-right: auto;
  }
  h2 {
    color: #004d40; text-align: center;
  }
  .container {
    background: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }
  label {
    display: block; margin-top: 10px; font-weight: bold; text-align: left;
  }
  input[type="text"], input[type="date"], input[type="password"] {
    width: 100%; padding: 10px; margin-top: 5px;
    border-radius: 6px; border: 1px solid #ccc; background: #f1f8e9;
  }
  button {
    margin-top: 15px; padding: 10px 20px; background: #4db6ac; border: none;
    color: white; border-radius: 6px; cursor: pointer;
  }
  button:hover {
    background: #00796b;
  }
  .logout-btn {
    margin-top: 10px;
    background: #616161;
  }
  footer {
    margin-top: 40px;
    font-size: 14px;
    color: #777;
    text-align: center;
  }
</style>
</head>
<body>
<h2>User Dashboard</h2>
<div class="container" id="profileSection">
  <form id="profileForm">
    <label>Full Name:</label>
    <input type="text" id="fullName" required />

    <label>Mobile Number:</label>
    <input type="text" id="phone" required />

    <label>Institution:</label>
    <input type="text" id="institute" required />

    <label>Date of Birth:</label>
    <input type="date" id="dob" required />

    <label>Gender:</label>
    <input type="text" id="gender" placeholder="Optional" />

    <button type="submit">Update Profile</button>
  </form>
</div>

<div class="container" style="margin-top:20px;">
  <h3>Change Password</h3>
  <form id="passwordForm">
    <label>Old Password:</label>
    <input type="password" id="oldPassword" required />
    <label>New Password:</label>
    <input type="password" id="newPassword" required />
    <label>Confirm New Password:</label>
    <input type="password" id="confirmPassword" required />
    <button type="submit">Change Password</button>
    <p id="passwordError" style="color:red;"></p>
  </form>
</div>

<div class="container" style="margin-top:20px;">
  <h3>Check SSC Results</h3>
  <form action="https://sresult.bise-ctg.gov.bd/rxto2025/individual/result.php" method="post" target="_blank">
    <label>SSC Roll 2025:</label>
    <input type="text" name="roll" required />
    <input type="submit" value="Check Result" />
  </form>
  <form action="https://sresult.bise-ctg.gov.bd/s24/individual/result.php" method="post" target="_blank" style="margin-top:10px;">
    <label>SSC Roll 2024:</label>
    <input type="text" name="roll" required />
    <input type="submit" value="Check Result" />
  </form>
  <form action="https://sresult.bise-ctg.gov.bd/s2023/individual/result.php" method="post" target="_blank" style="margin-top:10px;">
    <label>SSC Roll 2023:</label>
    <input type="text" name="roll" required />
    <input type="submit" value="Check Result" />
  </form>
  <form action="https://sresult.bise-ctg.gov.bd/s22/individual/result.php" method="post" target="_blank" style="margin-top:10px;">
    <label>SSC Roll 2022:</label>
    <input type="text" name="roll" required />
    <input type="submit" value="Check Result" />
  </form>
  <form action="https://sresult.bise-ctg.gov.bd/individual/result.php" method="post" target="_blank" style="margin-top:10px;">
    <label>SSC Roll 2021:</label>
    <input type="text" name="roll" required />
    <input type="submit" value="Check Result" />
  </form>
</div>

<button class="logout-btn" onclick="logout()">Logout</button>

<footer>Â© 2025 Abdullah Al Kawser</footer>

<script>
  // Redirect if not logged in
  const loggedInUser = JSON.parse(localStorage.getItem("loggedInUser"));
  if(!loggedInUser || localStorage.getItem("userRole") !== "user"){
    alert("Please login first.");
    window.location.href = "index.html";
  }

  // Populate profile fields
  document.getElementById("fullName").value = loggedInUser.fullName;
  document.getElementById("phone").value = loggedInUser.phone;
  document.getElementById("institute").value = loggedInUser.institute;
  document.getElementById("dob").value = loggedInUser.dob;
  document.getElementById("gender").value = loggedInUser.gender || "";

  // Profile update
  document.getElementById("profileForm").addEventListener("submit", function(e){
    e.preventDefault();
    let users = JSON.parse(localStorage.getItem("users")) || [];
    let userIndex = users.findIndex(u => u.username === loggedInUser.username);
    if(userIndex !== -1){
      users[userIndex].fullName = document.getElementById("fullName").value.trim();
      users[userIndex].phone = document.getElementById("phone").value.trim();
      users[userIndex].institute = document.getElementById("institute").value.trim();
      users[userIndex].dob = document.getElementById("dob").value;
      users[userIndex].gender = document.getElementById("gender").value.trim();
      localStorage.setItem("users", JSON.stringify(users));
      loggedInUser.fullName = users[userIndex].fullName;
      loggedInUser.phone = users[userIndex].phone;
      loggedInUser.institute = users[userIndex].institute;
      loggedInUser.dob = users[userIndex].dob;
      loggedInUser.gender = users[userIndex].gender;
      localStorage.setItem("loggedInUser", JSON.stringify(loggedInUser));
      alert("Profile updated successfully.");
    }
  });

  // Change password
  document.getElementById("passwordForm").addEventListener("submit", function(e){
    e.preventDefault();
    let oldPass = document.getElementById("oldPassword").value;
    let newPass = document.getElementById("newPassword").value;
    let confirmPass = document.getElementById("confirmPassword").value;
    const passwordError = document.getElementById("passwordError");

    if(newPass !== confirmPass){
      passwordError.innerText = "New password and confirm password do not match.";
      return;
    }
    if(oldPass !== loggedInUser.password){
      passwordError.innerText = "Old password is incorrect.";
      return;
    }
    let users = JSON.parse(localStorage.getItem("users")) || [];
    let userIndex = users.findIndex(u => u.username === loggedInUser.username);
    if(userIndex !== -1){
      users[userIndex].password = newPass;
      localStorage.setItem("users", JSON.stringify(users));
      loggedInUser.password = newPass;
      localStorage.setItem("loggedInUser", JSON.stringify(loggedInUser));
      alert("Password changed successfully.");
      passwordError.innerText = "";
      // Clear password fields
      document.getElementById("oldPassword").value = "";
      document.getElementById("newPassword").value = "";
      document.getElementById("confirmPassword").value = "";
    }
  });

  function logout(){
    localStorage.removeItem("loggedInUser");
    localStorage.removeItem("userRole");
    window.location.href = "index.html";
  }
</script>
</body>
</html>
